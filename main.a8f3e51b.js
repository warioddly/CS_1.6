(()=>{"use strict";var e,t={828:(e,t,n)=>{var o=new(n(963).x),i=n(686),r=n(6),a=new i.C({antialias:!0});a.setPixelRatio(window.devicePixelRatio),a.setSize(window.innerWidth,window.innerHeight),a.shadowMap.enabled=!0,a.shadowMap.type=r.dwk,a.toneMapping=r.LY2;var c=new(n(96).c)(75,window.innerWidth/window.innerHeight,.1,1e3);c.rotation.order="YXZ";var s=new(n(660).S),d=new(n(79).Z);document.body.appendChild(d.dom);var l,u={scene:o,renderer:a,camera:c,clock:s,stats:d,octree:new(n(427).V),configs:{player:{speed:.1,jumpSpeed:.2}},update:function(e){this.renderer.render(this.scene,this.camera),this.stats.update()}},p=n(532),h=n(524),y=function(){function e(){}return e.getSideVector=function(e,t,n){return e.getWorldDirection(t),t.y=0,t.normalize(),t.cross(e.up),t.multiplyScalar(n)},e.getForwardVector=function(e,t,n){return e.getWorldDirection(t),t.y=0,t.normalize(),t.multiplyScalar(n)},e}(),f=function(){function e(){}return e.isMobile=function(){return console.log(navigator.userAgent),/Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},e}(),m=n(936),v=window.location.href,w=function(e){return e.startsWith("/")||(e="/"+e),v.endsWith("/")?"".concat(v.slice(0,-1)).concat(e):"".concat(v).concat(e)},b=(l=function(e,t){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},l(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(e){function t(){var t=e.call(this)||this;return t.collider=new m.s(new p.P(0,.35,0),new p.P(0,1,0),.35),document.addEventListener("keydown",(function(e){t.keyStates[e.code]=!0})),document.addEventListener("keyup",(function(e){t.keyStates[e.code]=!1})),document.addEventListener("mousedown",(function(){return document.body.requestPointerLock()})),document.body.addEventListener("mousemove",(function(e){document.pointerLockElement===document.body&&(u.camera.rotation.y-=e.movementX/500,u.camera.rotation.x-=e.movementY/500)})),(new h.E).load(w("assets/objects/sas__cs2_agent_model_red/scene.gltf"),(function(e){t.model=e.scene,t.model.scale.set(.6,.6,.6),u.scene.add(t.model),t.initialized=!0})),t}return b(t,e),t.prototype.controls=function(e){var t=e*(this.playerOnFloor,8);this.keyStates.KeyW&&this.velocity.add(y.getForwardVector(u.camera,this.direction,t)),this.keyStates.KeyS&&this.velocity.add(y.getForwardVector(u.camera,this.direction,-t)),this.keyStates.KeyA&&this.velocity.add(y.getSideVector(u.camera,this.direction,-t)),this.keyStates.KeyD&&this.velocity.add(y.getSideVector(u.camera,this.direction,t))},t.prototype.updatePosition=function(e){var t=Math.exp(-4*e)-1;this.playerOnFloor||(this.velocity.y-=10*e,t*=.1),this.velocity.addScaledVector(this.velocity,t);var n=this.velocity.clone().multiplyScalar(e);this.collider.translate(n),u.camera.position.copy(this.collider.end)},t.prototype.updateCollision=function(e){var t=u.octree.capsuleIntersect(this.collider);this.playerOnFloor=!1,t&&(this.playerOnFloor=t.normal.y>0,this.playerOnFloor||this.velocity.addScaledVector(t.normal,-t.normal.dot(this.velocity)),this.collider.translate(t.normal.multiplyScalar(t.depth)))},t.prototype.update=function(e){if(this.initialized)for(var t=Math.min(.05,u.clock.getDelta())/5,n=0;n<5;n++)this.controls(t),this.updatePosition(t),this.updateCollision(t)},t}((function(){this.velocity=new p.P,this.direction=new p.P,this.keyStates={},this.playerOnFloor=!1,this.initialized=!1})),_=n(603),O=n(232),S=n(212),k=function(){function e(){var e=this;this.initialized=!1,u.scene.add(new _.M(16777215)),(new h.E).load(w("assets/objects/de_dust2_-_cs_map/scene.gltf"),(function(t){var n=t.scene,o=(new O.Z).setFromObject(n);n.position.sub(o.getCenter(new p.P)),n.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material.map&&(e.material.map.anisotropy=4))})),e.octreeHelper=new S.u(u.octree),e.octreeHelper.visible=!1,u.octree.fromGraphNode(n),u.scene.add(n,e.octreeHelper),e.initialized=!0})),document.body.appendChild(u.renderer.domElement),window.addEventListener("resize",this._resize.bind(this))}return e.prototype._resize=function(){u.camera.aspect=window.innerWidth/window.innerHeight,u.camera.updateProjectionMatrix(),u.renderer.setSize(window.innerWidth,window.innerHeight)},e}(),P=n(694),z=function(){function e(){var e=this.createControlDiv();document.body.appendChild(e),P.create({zone:e,mode:"dynamic",position:{left:"50%",top:"50%"},color:"red"})}return e.prototype.createControlDiv=function(){var e=document.createElement("div");return e.id="dynamic",e.classList.add("zone"),e.classList.add("dynamic"),e.classList.add("active"),e},e}(),E=function(){f.isMobile()&&new z},M=1e3/60,j=0;new(function(){function e(){new E,this.world=new k,this.player=new g,u.renderer.setAnimationLoop(this._animate.bind(this))}return e.prototype._animate=function(e){var t=e-j;t>M&&(this.player.update(e),u.update(e),j=e-t%M)},e}())}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,o),r.exports}o.m=t,e=[],o.O=(t,n,i,r)=>{if(!n){var a=1/0;for(l=0;l<e.length;l++){for(var[n,i,r]=e[l],c=!0,s=0;s<n.length;s++)(!1&r||a>=r)&&Object.keys(o.O).every((e=>o.O[e](n[s])))?n.splice(s--,1):(c=!1,r<a&&(a=r));if(c){e.splice(l--,1);var d=i();void 0!==d&&(t=d)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[n,i,r]},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var i,r,[a,c,s]=n,d=0;if(a.some((t=>0!==e[t]))){for(i in c)o.o(c,i)&&(o.m[i]=c[i]);if(s)var l=s(o)}for(t&&t(n);d<a.length;d++)r=a[d],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(l)},n=self.webpackChunkcounter_strike_1_6=self.webpackChunkcounter_strike_1_6||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=o.O(void 0,[225],(()=>o(828)));i=o.O(i)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5hOGYzZTUxYi5qcyIsIm1hcHBpbmdzIjoidUJBQUlBLEUscUJDQ09DLEVBQVEsSSxPQUFJLEcsZ0JDQW5CQyxFQUFXLElBQUksSUFBb0IsQ0FBRUMsV0FBVyxJQUNwREQsRUFBU0UsY0FBY0MsT0FBT0Msa0JBQzlCSixFQUFTSyxRQUFRRixPQUFPRyxXQUFZSCxPQUFPSSxhQUMzQ1AsRUFBU1EsVUFBVUMsU0FBVSxFQUM3QlQsRUFBU1EsVUFBVUUsS0FBTyxNQUMxQlYsRUFBU1csWUFBYyxNLElDTG5CQyxFQUFTLEksTUFBSSxHQUF3QixHQUFJVCxPQUFPRyxXQUFhSCxPQUFPSSxZQUFhLEdBQUssS0FDMUZLLEVBQU9DLFNBQVNDLE1BQVEsTSxJQ0RiQyxFQUFRLEksT0FBSSxHQ0NuQkMsRUFBUSxJLE1BQUksR0FDaEJDLFNBQVNDLEtBQUtDLFlBQVlILEVBQU1JLEssSUNGeEJDLEVDS0dDLEVBQU8sQ0FDZHZCLE1BQU9BLEVBQ1BDLFNBQVVBLEVBQ1ZZLE9BQVFBLEVBQ1JHLE1BQU9BLEVBQ1BDLE1BQU9BLEVBQ1BPLE9DVmdCLEksT0FBSSxHRFdwQkMsUUFBUyxDQUNMQyxPQUFRLENBQ0pDLE1BQU8sR0FDUEMsVUFBVyxLQUduQkMsT0FBUSxTQUFVQyxHQUNkQyxLQUFLOUIsU0FBUytCLE9BQU9ELEtBQUsvQixNQUFPK0IsS0FBS2xCLFFBQ3RDa0IsS0FBS2QsTUFBTVksUUFDZixHLGtCRXRCQUksRUFBZ0MsV0FDaEMsU0FBU0EsSUFDVCxDQWNBLE9BYkFBLEVBQWVDLGNBQWdCLFNBQVVyQixFQUFRc0IsRUFBV0wsR0FLeEQsT0FKQWpCLEVBQU91QixrQkFBa0JELEdBQ3pCQSxFQUFVRSxFQUFJLEVBQ2RGLEVBQVVHLFlBQ1ZILEVBQVVJLE1BQU0xQixFQUFPMkIsSUFDaEJMLEVBQVVNLGVBQWVYLEVBQ3BDLEVBQ0FHLEVBQWVTLGlCQUFtQixTQUFVN0IsRUFBUXNCLEVBQVdMLEdBSTNELE9BSEFqQixFQUFPdUIsa0JBQWtCRCxHQUN6QkEsRUFBVUUsRUFBSSxFQUNkRixFQUFVRyxZQUNISCxFQUFVTSxlQUFlWCxFQUNwQyxFQUNPRyxDQUNYLENBakJtQyxHQ0EvQlUsRUFBMkIsV0FDM0IsU0FBU0EsSUFDVCxDQU1BLE9BTEFBLEVBQVVDLFNBQVcsV0FHakIsT0FEQUMsUUFBUUMsSUFBSUMsVUFBVUMsV0FEVixzRUFFQ0MsS0FBS0YsVUFBVUMsVUFDaEMsRUFDT0wsQ0FDWCxDQVQ4QixHLFNDQTFCTyxFQUFPOUMsT0FBTytDLFNBQVNDLEtDQ2hCQyxFQUFlLFNBQVVDLEdBR2hDLE9BRktBLEVBQUtDLFdBQVcsT0FDakJELEVBQU8sSUFBTUEsR0FDYkosRUFBS00sU0FBUyxLQUNQLEdBQUdDLE9BQU9QLEVBQUtRLE1BQU0sR0FBSSxJQUFJRCxPQUFPSCxHQUN4QyxHQUFHRyxPQUFPUCxHQUFNTyxPQUFPSCxFQUNsQyxFTlBJSyxHQUNJckMsRUFBZ0IsU0FBVXNDLEVBQUdDLEdBSTdCLE9BSEF2QyxFQUFnQndDLE9BQU9DLGdCQUNsQixDQUFFQyxVQUFXLGNBQWdCQyxPQUFTLFNBQVVMLEVBQUdDLEdBQUtELEVBQUVJLFVBQVlILENBQUcsR0FDMUUsU0FBVUQsRUFBR0MsR0FBSyxJQUFLLElBQUlLLEtBQUtMLEVBQU9DLE9BQU9LLFVBQVVDLGVBQWVDLEtBQUtSLEVBQUdLLEtBQUlOLEVBQUVNLEdBQUtMLEVBQUVLLEdBQUksRUFDN0Y1QyxFQUFjc0MsRUFBR0MsRUFDNUIsRUFDTyxTQUFVRCxFQUFHQyxHQUNoQixHQUFpQixtQkFBTkEsR0FBMEIsT0FBTkEsRUFDM0IsTUFBTSxJQUFJUyxVQUFVLHVCQUF5QkMsT0FBT1YsR0FBSyxpQ0FFN0QsU0FBU1csSUFBT3pDLEtBQUswQyxZQUFjYixDQUFHLENBRHRDdEMsRUFBY3NDLEVBQUdDLEdBRWpCRCxFQUFFTyxVQUFrQixPQUFOTixFQUFhQyxPQUFPWSxPQUFPYixJQUFNVyxFQUFHTCxVQUFZTixFQUFFTSxVQUFXLElBQUlLLEVBQ25GLEdBVUFHLEVBQXdCLFNBQVVDLEdBRWxDLFNBQVNELElBQ0wsSUFBSUUsRUFBUUQsRUFBT1AsS0FBS3RDLE9BQVNBLEtBcUJqQyxPQXBCQThDLEVBQU1DLFNBQVcsSUFBSUMsRUFBQSxFQUFRLElBQUksSUFBYyxFQUFHLElBQU0sR0FBSSxJQUFJLElBQWMsRUFBRyxFQUFHLEdBQUksS0FDeEY3RCxTQUFTOEQsaUJBQWlCLFdBQVcsU0FBVUMsR0FDM0NKLEVBQU1LLFVBQVVELEVBQU1FLE9BQVEsQ0FDbEMsSUFDQWpFLFNBQVM4RCxpQkFBaUIsU0FBUyxTQUFVQyxHQUN6Q0osRUFBTUssVUFBVUQsRUFBTUUsT0FBUSxDQUNsQyxJQUNBakUsU0FBUzhELGlCQUFpQixhQUFhLFdBQWMsT0FBTzlELFNBQVNDLEtBQUtpRSxvQkFBc0IsSUFDaEdsRSxTQUFTQyxLQUFLNkQsaUJBQWlCLGFBQWEsU0FBVUMsR0FDOUMvRCxTQUFTbUUscUJBQXVCbkUsU0FBU0MsT0FDekNJLEVBQUtWLE9BQU9DLFNBQVN1QixHQUFLNEMsRUFBTUssVUtoQ2pCLElMaUNmL0QsRUFBS1YsT0FBT0MsU0FBU3lFLEdBQUtOLEVBQU1PLFVLakNqQixJTG1DdkIsS0FDQSxJQUFJQyxFQUFBLEdBQWFDLEtBQUtyQyxFQUFhLHVEQUF1RCxTQUFVc0MsR0FDaEdkLEVBQU1lLE1BQVFELEVBQUszRixNQUNuQjZFLEVBQU1lLE1BQU1DLE1BQU1DLElBQUksR0FBSyxHQUFLLElBQ2hDdkUsRUFBS3ZCLE1BQU0rRixJQUFJbEIsRUFBTWUsT0FDckJmLEVBQU1tQixhQUFjLENBQ3hCLElBQ09uQixDQUNYLENBZ0RBLE9BeEVBbEIsRUFBVWdCLEVBQVFDLEdBeUJsQkQsRUFBT1IsVUFBVThCLFNBQVcsU0FBVW5FLEdBQ2xDLElBQUlvRSxFQUFhcEUsR0FBTUMsS0FBS29FLGNLOUNSLEdMK0NoQnBFLEtBQUttRCxVQUFnQixNQUNyQm5ELEtBQUtxRSxTQUFTTCxJQUFJOUQsRUFBZVMsaUJBQWlCbkIsRUFBS1YsT0FBUWtCLEtBQUtJLFVBQVcrRCxJQUUvRW5FLEtBQUttRCxVQUFnQixNQUNyQm5ELEtBQUtxRSxTQUFTTCxJQUFJOUQsRUFBZVMsaUJBQWlCbkIsRUFBS1YsT0FBUWtCLEtBQUtJLFdBQVkrRCxJQUVoRm5FLEtBQUttRCxVQUFnQixNQUNyQm5ELEtBQUtxRSxTQUFTTCxJQUFJOUQsRUFBZUMsY0FBY1gsRUFBS1YsT0FBUWtCLEtBQUtJLFdBQVkrRCxJQUU3RW5FLEtBQUttRCxVQUFnQixNQUNyQm5ELEtBQUtxRSxTQUFTTCxJQUFJOUQsRUFBZUMsY0FBY1gsRUFBS1YsT0FBUWtCLEtBQUtJLFVBQVcrRCxHQUVwRixFQUNBdkIsRUFBT1IsVUFBVWtDLGVBQWlCLFNBQVV2RSxHQUN4QyxJQUFJd0UsRUFBVUMsS0FBS0MsS0FBSyxFQUFJMUUsR0FBTSxFQUM3QkMsS0FBS29FLGdCQUNOcEUsS0FBS3FFLFNBQVMvRCxHS2pFTixHTGlFMkJQLEVBQ25Dd0UsR0FBVyxJQUVmdkUsS0FBS3FFLFNBQVNLLGdCQUFnQjFFLEtBQUtxRSxTQUFVRSxHQUM3QyxJQUFJSSxFQUFnQjNFLEtBQUtxRSxTQUFTTyxRQUFRbEUsZUFBZVgsR0FDekRDLEtBQUsrQyxTQUFTOEIsVUFBVUYsR0FDeEJuRixFQUFLVixPQUFPZ0csU0FBU0MsS0FBSy9FLEtBQUsrQyxTQUFTaUMsSUFDNUMsRUFDQXBDLEVBQU9SLFVBQVU2QyxnQkFBa0IsU0FBVWxGLEdBQ3pDLElBQUltRixFQUFTMUYsRUFBS0MsT0FBTzBGLGlCQUFpQm5GLEtBQUsrQyxVQUMvQy9DLEtBQUtvRSxlQUFnQixFQUNqQmMsSUFDQWxGLEtBQUtvRSxjQUFnQmMsRUFBT0UsT0FBTzlFLEVBQUksRUFDbENOLEtBQUtvRSxlQUNOcEUsS0FBS3FFLFNBQVNLLGdCQUFnQlEsRUFBT0UsUUFBU0YsRUFBT0UsT0FBT0MsSUFBSXJGLEtBQUtxRSxXQUV6RXJFLEtBQUsrQyxTQUFTOEIsVUFBVUssRUFBT0UsT0FBTzFFLGVBQWV3RSxFQUFPSSxRQUVwRSxFQUNBMUMsRUFBT1IsVUFBVXRDLE9BQVMsU0FBVUMsR0FDaEMsR0FBS0MsS0FBS2lFLFlBR1YsSUFEQSxJQUFJc0IsRUFBYWYsS0FBS2dCLElBQUksSUFBTWhHLEVBQUtQLE1BQU13RyxZS3hGN0IsRUx5RkxDLEVBQUksRUFBR0EsRUt6RkYsRUx5RnVCQSxJQUNqQzFGLEtBQUtrRSxTQUFTcUIsR0FDZHZGLEtBQUtzRSxlQUFlaUIsR0FDcEJ2RixLQUFLaUYsZ0JBQWdCTSxFQUU3QixFQUNPM0MsQ0FDWCxDQTFFMkIsRU9yQnZCLFdBQ0k1QyxLQUFLcUUsU0FBVyxJQUFJLElBQ3BCckUsS0FBS0ksVUFBWSxJQUFJLElBQ3JCSixLQUFLbUQsVUFBWSxDQUFDLEVBQ2xCbkQsS0FBS29FLGVBQWdCLEVBQ3JCcEUsS0FBS2lFLGFBQWMsQ0FHdkIsSSwyQkNKQTBCLEVBQXVCLFdBQ3ZCLFNBQVNBLElBQ0wsSUFBSTdDLEVBQVE5QyxLQUNaQSxLQUFLaUUsYUFBYyxFQUNuQnpFLEVBQUt2QixNQUFNK0YsSUFBSSxJQUFJLElBQW1CLFlBQ3RDLElBQUlOLEVBQUEsR0FBYUMsS0FBS3JDLEVBQWEsZ0RBQWdELFNBQVVzQyxHQUN6RixJQUFJM0YsRUFBUTJGLEVBQUszRixNQUNiMkgsR0FBYyxJQUFJLEtBQWFDLGNBQWM1SCxHQUNqREEsRUFBTTZHLFNBQVNnQixJQUFJRixFQUFZRyxVQUFVLElBQUksTUFDN0M5SCxFQUFNK0gsVUFBUyxTQUFVQyxHQUNqQkEsRUFBTUMsU0FDTkQsRUFBTUUsWUFBYSxFQUNuQkYsRUFBTUcsZUFBZ0IsRUFDbEJILEVBQU1JLFNBQVNDLE1BQ2ZMLEVBQU1JLFNBQVNDLElBQUlDLFdBQWEsR0FHNUMsSUFDQXpELEVBQU0wRCxhQUFlLElBQUlDLEVBQUEsRUFBYWpILEVBQUtDLFFBQzNDcUQsRUFBTTBELGFBQWFFLFNBQVUsRUFDN0JsSCxFQUFLQyxPQUFPa0gsY0FBYzFJLEdBQzFCdUIsRUFBS3ZCLE1BQU0rRixJQUFJL0YsRUFBTzZFLEVBQU0wRCxjQUM1QjFELEVBQU1tQixhQUFjLENBQ3hCLElBQ0E5RSxTQUFTQyxLQUFLQyxZQUFZRyxFQUFLdEIsU0FBUzBJLFlBQ3hDdkksT0FBTzRFLGlCQUFpQixTQUFVakQsS0FBSzZHLFFBQVFDLEtBQUs5RyxNQUN4RCxDQU1BLE9BTEEyRixFQUFNdkQsVUFBVXlFLFFBQVUsV0FDdEJySCxFQUFLVixPQUFPaUksT0FBUzFJLE9BQU9HLFdBQWFILE9BQU9JLFlBQ2hEZSxFQUFLVixPQUFPa0kseUJBQ1p4SCxFQUFLdEIsU0FBU0ssUUFBUUYsT0FBT0csV0FBWUgsT0FBT0ksWUFDcEQsRUFDT2tILENBQ1gsQ0FqQzBCLEcsU0NMdEJzQixFQUE4QixXQUM5QixTQUFTQSxJQUNMLElBQUlDLEVBQWFsSCxLQUFLbUgsbUJBQ3RCaEksU0FBU0MsS0FBS0MsWUFBWTZILEdBQzFCRSxFQUFTekUsT0FBTyxDQUNaMEUsS0FBTUgsRUFDTkksS0FBTSxVQUNOeEMsU0FBVSxDQUFFeUMsS0FBTSxNQUFPQyxJQUFLLE9BQzlCQyxNQUFPLE9BRWYsQ0FTQSxPQVJBUixFQUFhN0UsVUFBVStFLGlCQUFtQixXQUN0QyxJQUFJTyxFQUFNdkksU0FBU3dJLGNBQWMsT0FLakMsT0FKQUQsRUFBSUUsR0FBSyxVQUNURixFQUFJRyxVQUFVN0QsSUFBSSxRQUNsQjBELEVBQUlHLFVBQVU3RCxJQUFJLFdBQ2xCMEQsRUFBSUcsVUFBVTdELElBQUksVUFDWDBELENBQ1gsRUFDT1QsQ0FDWCxDQXBCaUMsR0NDN0JhLEVBQ0EsV0FFUWxILEVBQVVDLFlBQ1YsSUFBSW9HLENBRVosRUNIQWMsRUFBYSxJQURKLEdBRVRDLEVBQWdCLEVBa0JwQixJQWpCNEIsV0FDeEIsU0FBU0MsSUFDTCxJQUFJSCxFQUNKOUgsS0FBS2tJLE1BQVEsSUFBSXZDLEVBQ2pCM0YsS0FBS0wsT0FBUyxJQUFJaUQsRUFDbEJwRCxFQUFLdEIsU0FBU2lLLGlCQUFpQm5JLEtBQUtvSSxTQUFTdEIsS0FBSzlHLE1BQ3RELENBU0EsT0FSQWlJLEVBQU83RixVQUFVZ0csU0FBVyxTQUFVckksR0FDbEMsSUFBSXNJLEVBQVV0SSxFQUFLaUksRUFDZkssRUFBVU4sSUFDVi9ILEtBQUtMLE9BQU9HLE9BQU9DLEdBQ25CUCxFQUFLTSxPQUFPQyxHQUNaaUksRUFBZ0JqSSxFQUFNc0ksRUFBVU4sRUFFeEMsRUFDT0UsQ0FDWCxDQWhCMkIsRyxHQ052QkssRUFBMkIsQ0FBQyxFQUdoQyxTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUgsRUFBeUJFLEdBQzVDLFFBQXFCRSxJQUFqQkQsRUFDSCxPQUFPQSxFQUFhRSxRQUdyQixJQUFJQyxFQUFTTixFQUF5QkUsR0FBWSxDQUdqREcsUUFBUyxDQUFDLEdBT1gsT0FIQUUsRUFBb0JMLEdBQVVJLEVBQVFBLEVBQU9ELFFBQVNKLEdBRy9DSyxFQUFPRCxPQUNmLENBR0FKLEVBQW9CTyxFQUFJRCxFbEJ6QnBCN0ssRUFBVyxHQUNmdUssRUFBb0JRLEVBQUksQ0FBQzdELEVBQVE4RCxFQUFVQyxFQUFJQyxLQUM5QyxJQUFHRixFQUFILENBTUEsSUFBSUcsRUFBZUMsSUFDbkIsSUFBUzFELEVBQUksRUFBR0EsRUFBSTFILEVBQVNxTCxPQUFRM0QsSUFBSyxDQUd6QyxJQUZBLElBQUtzRCxFQUFVQyxFQUFJQyxHQUFZbEwsRUFBUzBILEdBQ3BDNEQsR0FBWSxFQUNQQyxFQUFJLEVBQUdBLEVBQUlQLEVBQVNLLE9BQVFFLE1BQ3BCLEVBQVhMLEdBQXNCQyxHQUFnQkQsSUFBYW5ILE9BQU95SCxLQUFLakIsRUFBb0JRLEdBQUdVLE9BQU9DLEdBQVNuQixFQUFvQlEsRUFBRVcsR0FBS1YsRUFBU08sTUFDOUlQLEVBQVNXLE9BQU9KLElBQUssSUFFckJELEdBQVksRUFDVEosRUFBV0MsSUFBY0EsRUFBZUQsSUFHN0MsR0FBR0ksRUFBVyxDQUNidEwsRUFBUzJMLE9BQU9qRSxJQUFLLEdBQ3JCLElBQUlrRSxFQUFJWCxTQUNFUCxJQUFOa0IsSUFBaUIxRSxFQUFTMEUsRUFDL0IsQ0FDRCxDQUNBLE9BQU8xRSxDQW5CUCxDQUpDZ0UsRUFBV0EsR0FBWSxFQUN2QixJQUFJLElBQUl4RCxFQUFJMUgsRUFBU3FMLE9BQVEzRCxFQUFJLEdBQUsxSCxFQUFTMEgsRUFBSSxHQUFHLEdBQUt3RCxFQUFVeEQsSUFBSzFILEVBQVMwSCxHQUFLMUgsRUFBUzBILEVBQUksR0FDckcxSCxFQUFTMEgsR0FBSyxDQUFDc0QsRUFBVUMsRUFBSUMsRUFxQmpCLEVtQnpCZFgsRUFBb0IxRyxFQUFJLENBQUM4RyxFQUFTa0IsS0FDakMsSUFBSSxJQUFJSCxLQUFPRyxFQUNYdEIsRUFBb0J1QixFQUFFRCxFQUFZSCxLQUFTbkIsRUFBb0J1QixFQUFFbkIsRUFBU2UsSUFDNUUzSCxPQUFPZ0ksZUFBZXBCLEVBQVNlLEVBQUssQ0FBRU0sWUFBWSxFQUFNQyxJQUFLSixFQUFXSCxJQUUxRSxFQ05EbkIsRUFBb0J1QixFQUFJLENBQUNJLEVBQUtDLElBQVVwSSxPQUFPSyxVQUFVQyxlQUFlQyxLQUFLNEgsRUFBS0MsRyxNQ0tsRixJQUFJQyxFQUFrQixDQUNyQixJQUFLLEdBYU43QixFQUFvQlEsRUFBRVEsRUFBS2MsR0FBMEMsSUFBN0JELEVBQWdCQyxHQUd4RCxJQUFJQyxFQUF1QixDQUFDQyxFQUE0QkMsS0FDdkQsSUFHSWhDLEVBQVU2QixHQUhUckIsRUFBVXlCLEVBQWFDLEdBQVdGLEVBR2hCOUUsRUFBSSxFQUMzQixHQUFHc0QsRUFBUzJCLE1BQU0vQyxHQUFnQyxJQUF4QndDLEVBQWdCeEMsS0FBYSxDQUN0RCxJQUFJWSxLQUFZaUMsRUFDWmxDLEVBQW9CdUIsRUFBRVcsRUFBYWpDLEtBQ3JDRCxFQUFvQk8sRUFBRU4sR0FBWWlDLEVBQVlqQyxJQUdoRCxHQUFHa0MsRUFBUyxJQUFJeEYsRUFBU3dGLEVBQVFuQyxFQUNsQyxDQUVBLElBREdnQyxHQUE0QkEsRUFBMkJDLEdBQ3JEOUUsRUFBSXNELEVBQVNLLE9BQVEzRCxJQUN6QjJFLEVBQVVyQixFQUFTdEQsR0FDaEI2QyxFQUFvQnVCLEVBQUVNLEVBQWlCQyxJQUFZRCxFQUFnQkMsSUFDckVELEVBQWdCQyxHQUFTLEtBRTFCRCxFQUFnQkMsR0FBVyxFQUU1QixPQUFPOUIsRUFBb0JRLEVBQUU3RCxFQUFPLEVBR2pDMEYsRUFBcUJDLEtBQXFDLCtCQUFJQSxLQUFxQyxnQ0FBSyxHQUM1R0QsRUFBbUJFLFFBQVFSLEVBQXFCeEQsS0FBSyxLQUFNLElBQzNEOEQsRUFBbUJHLEtBQU9ULEVBQXFCeEQsS0FBSyxLQUFNOEQsRUFBbUJHLEtBQUtqRSxLQUFLOEQsRyxLQzdDdkYsSUFBSUksRUFBc0J6QyxFQUFvQlEsT0FBRUwsRUFBVyxDQUFDLE1BQU0sSUFBT0gsRUFBb0IsT0FDN0Z5QyxFQUFzQnpDLEVBQW9CUSxFQUFFaUMsRSIsInNvdXJjZXMiOlsid2VicGFjazovL2NvdW50ZXJfc3RyaWtlXzEuNi93ZWJwYWNrL3J1bnRpbWUvY2h1bmsgbG9hZGVkIiwid2VicGFjazovL2NvdW50ZXJfc3RyaWtlXzEuNi8uL3NyYy9tb2R1bGVzL3NjZW5lLnRzIiwid2VicGFjazovL2NvdW50ZXJfc3RyaWtlXzEuNi8uL3NyYy9tb2R1bGVzL3JlbmRlcmVyLnRzIiwid2VicGFjazovL2NvdW50ZXJfc3RyaWtlXzEuNi8uL3NyYy9tb2R1bGVzL2NhbWVyYS50cyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvLi9zcmMvbW9kdWxlcy9jbG9jay50cyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvLi9zcmMvbW9kdWxlcy9zdGF0cy50cyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvLi9zcmMvYWN0b3JzL3BsYXllci50cyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvLi9zcmMvbW9kdWxlcy9pbmRleC50cyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvLi9zcmMvbW9kdWxlcy9vY3RyZWUudHMiLCJ3ZWJwYWNrOi8vY291bnRlcl9zdHJpa2VfMS42Ly4vc3JjL3V0aWxzL2NoYXJhY3Rlci50cyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvLi9zcmMvdXRpbHMvdXNlci50cyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvLi9zcmMvY29uc3RhbnRzLnRzIiwid2VicGFjazovL2NvdW50ZXJfc3RyaWtlXzEuNi8uL3NyYy91dGlscy9wYXRoX3Jlc29sdmVyLnRzIiwid2VicGFjazovL2NvdW50ZXJfc3RyaWtlXzEuNi8uL3NyYy9hY3RvcnMvY2hhcmFjdGVyLnRzIiwid2VicGFjazovL2NvdW50ZXJfc3RyaWtlXzEuNi8uL3NyYy93b3JsZC9pbmRleC50cyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvLi9zcmMvbW9kdWxlcy90b3VjaC50cyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvLi9zcmMvbW9kdWxlcy9wbGF0Zm9ybS50cyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvLi9zcmMvbWFpbi50cyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vY291bnRlcl9zdHJpa2VfMS42L3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9jb3VudGVyX3N0cmlrZV8xLjYvd2VicGFjay9ydW50aW1lL2pzb25wIGNodW5rIGxvYWRpbmciLCJ3ZWJwYWNrOi8vY291bnRlcl9zdHJpa2VfMS42L3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZGVmZXJyZWQgPSBbXTtcbl9fd2VicGFja19yZXF1aXJlX18uTyA9IChyZXN1bHQsIGNodW5rSWRzLCBmbiwgcHJpb3JpdHkpID0+IHtcblx0aWYoY2h1bmtJZHMpIHtcblx0XHRwcmlvcml0eSA9IHByaW9yaXR5IHx8IDA7XG5cdFx0Zm9yKHZhciBpID0gZGVmZXJyZWQubGVuZ3RoOyBpID4gMCAmJiBkZWZlcnJlZFtpIC0gMV1bMl0gPiBwcmlvcml0eTsgaS0tKSBkZWZlcnJlZFtpXSA9IGRlZmVycmVkW2kgLSAxXTtcblx0XHRkZWZlcnJlZFtpXSA9IFtjaHVua0lkcywgZm4sIHByaW9yaXR5XTtcblx0XHRyZXR1cm47XG5cdH1cblx0dmFyIG5vdEZ1bGZpbGxlZCA9IEluZmluaXR5O1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IGRlZmVycmVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIFtjaHVua0lkcywgZm4sIHByaW9yaXR5XSA9IGRlZmVycmVkW2ldO1xuXHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgY2h1bmtJZHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdGlmICgocHJpb3JpdHkgJiAxID09PSAwIHx8IG5vdEZ1bGZpbGxlZCA+PSBwcmlvcml0eSkgJiYgT2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5PKS5ldmVyeSgoa2V5KSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXy5PW2tleV0oY2h1bmtJZHNbal0pKSkpIHtcblx0XHRcdFx0Y2h1bmtJZHMuc3BsaWNlKGotLSwgMSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmdWxmaWxsZWQgPSBmYWxzZTtcblx0XHRcdFx0aWYocHJpb3JpdHkgPCBub3RGdWxmaWxsZWQpIG5vdEZ1bGZpbGxlZCA9IHByaW9yaXR5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihmdWxmaWxsZWQpIHtcblx0XHRcdGRlZmVycmVkLnNwbGljZShpLS0sIDEpXG5cdFx0XHR2YXIgciA9IGZuKCk7XG5cdFx0XHRpZiAociAhPT0gdW5kZWZpbmVkKSByZXN1bHQgPSByO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTsiLCJpbXBvcnQgKiBhcyBUSFJFRSBmcm9tICd0aHJlZSc7XG5leHBvcnQgdmFyIHNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG4iLCJpbXBvcnQgKiBhcyBUSFJFRSBmcm9tICd0aHJlZSc7XG52YXIgcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7IGFudGlhbGlhczogdHJ1ZSB9KTtcbnJlbmRlcmVyLnNldFBpeGVsUmF0aW8od2luZG93LmRldmljZVBpeGVsUmF0aW8pO1xucmVuZGVyZXIuc2V0U2l6ZSh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTtcbnJlbmRlcmVyLnNoYWRvd01hcC5lbmFibGVkID0gdHJ1ZTtcbnJlbmRlcmVyLnNoYWRvd01hcC50eXBlID0gVEhSRUUuVlNNU2hhZG93TWFwO1xucmVuZGVyZXIudG9uZU1hcHBpbmcgPSBUSFJFRS5BQ0VTRmlsbWljVG9uZU1hcHBpbmc7XG5leHBvcnQgeyByZW5kZXJlciB9O1xuIiwiaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnO1xudmFyIGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg3NSwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDAuMSwgMTAwMCk7XG5jYW1lcmEucm90YXRpb24ub3JkZXIgPSAnWVhaJztcbmV4cG9ydCB7IGNhbWVyYSB9O1xuIiwiaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnO1xuZXhwb3J0IHZhciBjbG9jayA9IG5ldyBUSFJFRS5DbG9jaygpO1xuIiwiLy8gQHRzLWlnbm9yZVxuaW1wb3J0IFN0YXRzIGZyb20gJ3RocmVlL2FkZG9ucy9saWJzL3N0YXRzLm1vZHVsZS5qcyc7XG52YXIgc3RhdHMgPSBuZXcgU3RhdHMoKTtcbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc3RhdHMuZG9tKTtcbmV4cG9ydCB7IHN0YXRzIH07XG4iLCJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnO1xuaW1wb3J0IHsgZ2FtZSB9IGZyb20gXCIuLi9tb2R1bGVzXCI7XG5pbXBvcnQgeyBHTFRGTG9hZGVyIH0gZnJvbSAndGhyZWUvZXhhbXBsZXMvanNtL2xvYWRlcnMvR0xURkxvYWRlcic7XG5pbXBvcnQgeyBDaGFyYWN0ZXIgfSBmcm9tIFwiLi9jaGFyYWN0ZXJcIjtcbmltcG9ydCB7IENoYXJhY3RlclV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzXCI7XG5pbXBvcnQgeyBDYXBzdWxlIH0gZnJvbSBcInRocmVlL2V4YW1wbGVzL2pzbS9tYXRoL0NhcHN1bGVcIjtcbmltcG9ydCB7IHBhdGhSZXNvbHZlciB9IGZyb20gXCIuLi91dGlscy9wYXRoX3Jlc29sdmVyXCI7XG5pbXBvcnQgeyBQTEFZRVJfU1BFRUQsIFNURVBTX1BFUl9GUkFNRSwgUExBWUVSX01PVVNFX1NFTlNJVElWSVRZLCBXT1JMRF9HUkFWSVRZLCBQTEFZRVJfT05fRkxPT1JfU1BFRUQgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG52YXIgUGxheWVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhQbGF5ZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUGxheWVyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5jb2xsaWRlciA9IG5ldyBDYXBzdWxlKG5ldyBUSFJFRS5WZWN0b3IzKDAsIDAuMzUsIDApLCBuZXcgVEhSRUUuVmVjdG9yMygwLCAxLCAwKSwgMC4zNSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIF90aGlzLmtleVN0YXRlc1tldmVudC5jb2RlXSA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgX3RoaXMua2V5U3RhdGVzW2V2ZW50LmNvZGVdID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoKSB7IHJldHVybiBkb2N1bWVudC5ib2R5LnJlcXVlc3RQb2ludGVyTG9jaygpOyB9KTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5wb2ludGVyTG9ja0VsZW1lbnQgPT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgICAgICAgICBnYW1lLmNhbWVyYS5yb3RhdGlvbi55IC09IGV2ZW50Lm1vdmVtZW50WCAvIFBMQVlFUl9NT1VTRV9TRU5TSVRJVklUWTtcbiAgICAgICAgICAgICAgICBnYW1lLmNhbWVyYS5yb3RhdGlvbi54IC09IGV2ZW50Lm1vdmVtZW50WSAvIFBMQVlFUl9NT1VTRV9TRU5TSVRJVklUWTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIG5ldyBHTFRGTG9hZGVyKCkubG9hZChwYXRoUmVzb2x2ZXIoJ2Fzc2V0cy9vYmplY3RzL3Nhc19fY3MyX2FnZW50X21vZGVsX3JlZC9zY2VuZS5nbHRmJyksIGZ1bmN0aW9uIChnbHRmKSB7XG4gICAgICAgICAgICBfdGhpcy5tb2RlbCA9IGdsdGYuc2NlbmU7XG4gICAgICAgICAgICBfdGhpcy5tb2RlbC5zY2FsZS5zZXQoMC42LCAwLjYsIDAuNik7XG4gICAgICAgICAgICBnYW1lLnNjZW5lLmFkZChfdGhpcy5tb2RlbCk7XG4gICAgICAgICAgICBfdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFBsYXllci5wcm90b3R5cGUuY29udHJvbHMgPSBmdW5jdGlvbiAoZHQpIHtcbiAgICAgICAgdmFyIHNwZWVkRGVsdGEgPSBkdCAqICh0aGlzLnBsYXllck9uRmxvb3IgPyBQTEFZRVJfT05fRkxPT1JfU1BFRUQgOiBQTEFZRVJfU1BFRUQpO1xuICAgICAgICBpZiAodGhpcy5rZXlTdGF0ZXNbJ0tleVcnXSkge1xuICAgICAgICAgICAgdGhpcy52ZWxvY2l0eS5hZGQoQ2hhcmFjdGVyVXRpbHMuZ2V0Rm9yd2FyZFZlY3RvcihnYW1lLmNhbWVyYSwgdGhpcy5kaXJlY3Rpb24sIHNwZWVkRGVsdGEpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5rZXlTdGF0ZXNbJ0tleVMnXSkge1xuICAgICAgICAgICAgdGhpcy52ZWxvY2l0eS5hZGQoQ2hhcmFjdGVyVXRpbHMuZ2V0Rm9yd2FyZFZlY3RvcihnYW1lLmNhbWVyYSwgdGhpcy5kaXJlY3Rpb24sIC1zcGVlZERlbHRhKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMua2V5U3RhdGVzWydLZXlBJ10pIHtcbiAgICAgICAgICAgIHRoaXMudmVsb2NpdHkuYWRkKENoYXJhY3RlclV0aWxzLmdldFNpZGVWZWN0b3IoZ2FtZS5jYW1lcmEsIHRoaXMuZGlyZWN0aW9uLCAtc3BlZWREZWx0YSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmtleVN0YXRlc1snS2V5RCddKSB7XG4gICAgICAgICAgICB0aGlzLnZlbG9jaXR5LmFkZChDaGFyYWN0ZXJVdGlscy5nZXRTaWRlVmVjdG9yKGdhbWUuY2FtZXJhLCB0aGlzLmRpcmVjdGlvbiwgc3BlZWREZWx0YSkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQbGF5ZXIucHJvdG90eXBlLnVwZGF0ZVBvc2l0aW9uID0gZnVuY3Rpb24gKGR0KSB7XG4gICAgICAgIHZhciBkYW1waW5nID0gTWF0aC5leHAoLTQgKiBkdCkgLSAxO1xuICAgICAgICBpZiAoIXRoaXMucGxheWVyT25GbG9vcikge1xuICAgICAgICAgICAgdGhpcy52ZWxvY2l0eS55IC09IFdPUkxEX0dSQVZJVFkgKiBkdDtcbiAgICAgICAgICAgIGRhbXBpbmcgKj0gMC4xO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmVsb2NpdHkuYWRkU2NhbGVkVmVjdG9yKHRoaXMudmVsb2NpdHksIGRhbXBpbmcpO1xuICAgICAgICB2YXIgZGVsdGFQb3NpdGlvbiA9IHRoaXMudmVsb2NpdHkuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihkdCk7XG4gICAgICAgIHRoaXMuY29sbGlkZXIudHJhbnNsYXRlKGRlbHRhUG9zaXRpb24pO1xuICAgICAgICBnYW1lLmNhbWVyYS5wb3NpdGlvbi5jb3B5KHRoaXMuY29sbGlkZXIuZW5kKTtcbiAgICB9O1xuICAgIFBsYXllci5wcm90b3R5cGUudXBkYXRlQ29sbGlzaW9uID0gZnVuY3Rpb24gKGR0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBnYW1lLm9jdHJlZS5jYXBzdWxlSW50ZXJzZWN0KHRoaXMuY29sbGlkZXIpO1xuICAgICAgICB0aGlzLnBsYXllck9uRmxvb3IgPSBmYWxzZTtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXJPbkZsb29yID0gcmVzdWx0Lm5vcm1hbC55ID4gMDtcbiAgICAgICAgICAgIGlmICghdGhpcy5wbGF5ZXJPbkZsb29yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52ZWxvY2l0eS5hZGRTY2FsZWRWZWN0b3IocmVzdWx0Lm5vcm1hbCwgLXJlc3VsdC5ub3JtYWwuZG90KHRoaXMudmVsb2NpdHkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY29sbGlkZXIudHJhbnNsYXRlKHJlc3VsdC5ub3JtYWwubXVsdGlwbHlTY2FsYXIocmVzdWx0LmRlcHRoKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBsYXllci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGR0KSB7XG4gICAgICAgIGlmICghdGhpcy5pbml0aWFsaXplZClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGRlbHRhVGltZSA9IChNYXRoLm1pbigwLjA1LCBnYW1lLmNsb2NrLmdldERlbHRhKCkpIC8gU1RFUFNfUEVSX0ZSQU1FKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBTVEVQU19QRVJfRlJBTUU7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5jb250cm9scyhkZWx0YVRpbWUpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVQb3NpdGlvbihkZWx0YVRpbWUpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVDb2xsaXNpb24oZGVsdGFUaW1lKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFBsYXllcjtcbn0oQ2hhcmFjdGVyKSk7XG5leHBvcnQgeyBQbGF5ZXIgfTtcbiIsImltcG9ydCB7IHNjZW5lIH0gZnJvbSBcIi4vc2NlbmVcIjtcbmltcG9ydCB7IHJlbmRlcmVyIH0gZnJvbSBcIi4vcmVuZGVyZXJcIjtcbmltcG9ydCB7IGNhbWVyYSB9IGZyb20gXCIuL2NhbWVyYVwiO1xuaW1wb3J0IHsgY2xvY2sgfSBmcm9tIFwiLi9jbG9ja1wiO1xuaW1wb3J0IHsgc3RhdHMgfSBmcm9tIFwiLi9zdGF0c1wiO1xuaW1wb3J0IHsgb2N0cmVlIH0gZnJvbSBcIi4vb2N0cmVlXCI7XG5leHBvcnQgdmFyIGdhbWUgPSB7XG4gICAgc2NlbmU6IHNjZW5lLFxuICAgIHJlbmRlcmVyOiByZW5kZXJlcixcbiAgICBjYW1lcmE6IGNhbWVyYSxcbiAgICBjbG9jazogY2xvY2ssXG4gICAgc3RhdHM6IHN0YXRzLFxuICAgIG9jdHJlZTogb2N0cmVlLFxuICAgIGNvbmZpZ3M6IHtcbiAgICAgICAgcGxheWVyOiB7XG4gICAgICAgICAgICBzcGVlZDogMC4xLFxuICAgICAgICAgICAganVtcFNwZWVkOiAwLjIsXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcih0aGlzLnNjZW5lLCB0aGlzLmNhbWVyYSk7XG4gICAgICAgIHRoaXMuc3RhdHMudXBkYXRlKCk7XG4gICAgfVxufTtcbiIsIi8vIEB0cy1pZ25vcmVcbmltcG9ydCB7IE9jdHJlZSB9IGZyb20gJ3RocmVlL2FkZG9ucy9tYXRoL09jdHJlZS5qcyc7XG5leHBvcnQgdmFyIG9jdHJlZSA9IG5ldyBPY3RyZWUoKTtcbiIsInZhciBDaGFyYWN0ZXJVdGlscyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDaGFyYWN0ZXJVdGlscygpIHtcbiAgICB9XG4gICAgQ2hhcmFjdGVyVXRpbHMuZ2V0U2lkZVZlY3RvciA9IGZ1bmN0aW9uIChjYW1lcmEsIGRpcmVjdGlvbiwgZHQpIHtcbiAgICAgICAgY2FtZXJhLmdldFdvcmxkRGlyZWN0aW9uKGRpcmVjdGlvbik7XG4gICAgICAgIGRpcmVjdGlvbi55ID0gMDtcbiAgICAgICAgZGlyZWN0aW9uLm5vcm1hbGl6ZSgpO1xuICAgICAgICBkaXJlY3Rpb24uY3Jvc3MoY2FtZXJhLnVwKTtcbiAgICAgICAgcmV0dXJuIGRpcmVjdGlvbi5tdWx0aXBseVNjYWxhcihkdCk7XG4gICAgfTtcbiAgICBDaGFyYWN0ZXJVdGlscy5nZXRGb3J3YXJkVmVjdG9yID0gZnVuY3Rpb24gKGNhbWVyYSwgZGlyZWN0aW9uLCBkdCkge1xuICAgICAgICBjYW1lcmEuZ2V0V29ybGREaXJlY3Rpb24oZGlyZWN0aW9uKTtcbiAgICAgICAgZGlyZWN0aW9uLnkgPSAwO1xuICAgICAgICBkaXJlY3Rpb24ubm9ybWFsaXplKCk7XG4gICAgICAgIHJldHVybiBkaXJlY3Rpb24ubXVsdGlwbHlTY2FsYXIoZHQpO1xuICAgIH07XG4gICAgcmV0dXJuIENoYXJhY3RlclV0aWxzO1xufSgpKTtcbmV4cG9ydCB7IENoYXJhY3RlclV0aWxzIH07XG4iLCJ2YXIgVXNlclV0aWxzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFVzZXJVdGlscygpIHtcbiAgICB9XG4gICAgVXNlclV0aWxzLmlzTW9iaWxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVnZXggPSAvTW9iaXxBbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2k7XG4gICAgICAgIGNvbnNvbGUubG9nKG5hdmlnYXRvci51c2VyQWdlbnQpO1xuICAgICAgICByZXR1cm4gcmVnZXgudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcbiAgICB9O1xuICAgIHJldHVybiBVc2VyVXRpbHM7XG59KCkpO1xuZXhwb3J0IHsgVXNlclV0aWxzIH07XG4iLCJ2YXIgSE9TVCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xudmFyIFNURVBTX1BFUl9GUkFNRSA9IDU7XG52YXIgV09STERfR1JBVklUWSA9IDEwO1xudmFyIFBMQVlFUl9TUEVFRCA9IDg7XG52YXIgUExBWUVSX09OX0ZMT09SX1NQRUVEID0gODtcbnZhciBQTEFZRVJfTU9VU0VfU0VOU0lUSVZJVFkgPSA1MDA7XG5leHBvcnQgeyBIT1NULCBTVEVQU19QRVJfRlJBTUUsIFdPUkxEX0dSQVZJVFksIFBMQVlFUl9TUEVFRCwgUExBWUVSX09OX0ZMT09SX1NQRUVELCBQTEFZRVJfTU9VU0VfU0VOU0lUSVZJVFksIH07XG4iLCJpbXBvcnQgeyBIT1NUIH0gZnJvbSBcIi4uL2NvbnN0YW50c1wiO1xuZXhwb3J0IHZhciBwYXRoUmVzb2x2ZXIgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgIGlmICghcGF0aC5zdGFydHNXaXRoKCcvJykpXG4gICAgICAgIHBhdGggPSAnLycgKyBwYXRoO1xuICAgIGlmIChIT1NULmVuZHNXaXRoKCcvJykpXG4gICAgICAgIHJldHVybiBcIlwiLmNvbmNhdChIT1NULnNsaWNlKDAsIC0xKSkuY29uY2F0KHBhdGgpO1xuICAgIHJldHVybiBcIlwiLmNvbmNhdChIT1NUKS5jb25jYXQocGF0aCk7XG59O1xuIiwiaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnO1xudmFyIENoYXJhY3RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDaGFyYWN0ZXIoKSB7XG4gICAgICAgIHRoaXMudmVsb2NpdHkgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgICAgIHRoaXMua2V5U3RhdGVzID0ge307XG4gICAgICAgIHRoaXMucGxheWVyT25GbG9vciA9IGZhbHNlO1xuICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAgIC8vIGFic3RyYWN0IHJlc3Bhd24oKTtcbiAgICAgICAgLy8gYWJzdHJhY3QgdGFrZURhbWFnZSgpO1xuICAgIH1cbiAgICByZXR1cm4gQ2hhcmFjdGVyO1xufSgpKTtcbmV4cG9ydCB7IENoYXJhY3RlciB9O1xuIiwiaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnO1xuaW1wb3J0IHsgR0xURkxvYWRlciB9IGZyb20gJ3RocmVlL2V4YW1wbGVzL2pzbS9sb2FkZXJzL0dMVEZMb2FkZXInO1xuLy8gQHRzLWlnbm9yZVxuaW1wb3J0IHsgT2N0cmVlSGVscGVyIH0gZnJvbSAndGhyZWUvYWRkb25zL2hlbHBlcnMvT2N0cmVlSGVscGVyLmpzJztcbmltcG9ydCB7IGdhbWUgfSBmcm9tIFwiLi4vbW9kdWxlc1wiO1xuaW1wb3J0IHsgcGF0aFJlc29sdmVyIH0gZnJvbSBcIi4uL3V0aWxzL3BhdGhfcmVzb2x2ZXJcIjtcbnZhciBXb3JsZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBXb3JsZCgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuICAgICAgICBnYW1lLnNjZW5lLmFkZChuZXcgVEhSRUUuQW1iaWVudExpZ2h0KDB4RkZGRkZGKSk7XG4gICAgICAgIG5ldyBHTFRGTG9hZGVyKCkubG9hZChwYXRoUmVzb2x2ZXIoJ2Fzc2V0cy9vYmplY3RzL2RlX2R1c3QyXy1fY3NfbWFwL3NjZW5lLmdsdGYnKSwgZnVuY3Rpb24gKGdsdGYpIHtcbiAgICAgICAgICAgIHZhciBzY2VuZSA9IGdsdGYuc2NlbmU7XG4gICAgICAgICAgICB2YXIgYm91bmRpbmdCb3ggPSBuZXcgVEhSRUUuQm94MygpLnNldEZyb21PYmplY3Qoc2NlbmUpO1xuICAgICAgICAgICAgc2NlbmUucG9zaXRpb24uc3ViKGJvdW5kaW5nQm94LmdldENlbnRlcihuZXcgVEhSRUUuVmVjdG9yMygpKSk7XG4gICAgICAgICAgICBzY2VuZS50cmF2ZXJzZShmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGQuaXNNZXNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLmNhc3RTaGFkb3cgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjaGlsZC5yZWNlaXZlU2hhZG93ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkLm1hdGVyaWFsLm1hcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQubWF0ZXJpYWwubWFwLmFuaXNvdHJvcHkgPSA0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfdGhpcy5vY3RyZWVIZWxwZXIgPSBuZXcgT2N0cmVlSGVscGVyKGdhbWUub2N0cmVlKTtcbiAgICAgICAgICAgIF90aGlzLm9jdHJlZUhlbHBlci52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICBnYW1lLm9jdHJlZS5mcm9tR3JhcGhOb2RlKHNjZW5lKTtcbiAgICAgICAgICAgIGdhbWUuc2NlbmUuYWRkKHNjZW5lLCBfdGhpcy5vY3RyZWVIZWxwZXIpO1xuICAgICAgICAgICAgX3RoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChnYW1lLnJlbmRlcmVyLmRvbUVsZW1lbnQpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5fcmVzaXplLmJpbmQodGhpcykpO1xuICAgIH1cbiAgICBXb3JsZC5wcm90b3R5cGUuX3Jlc2l6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZ2FtZS5jYW1lcmEuYXNwZWN0ID0gd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgICAgIGdhbWUuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTtcbiAgICAgICAgZ2FtZS5yZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuICAgIH07XG4gICAgcmV0dXJuIFdvcmxkO1xufSgpKTtcbmV4cG9ydCB7IFdvcmxkIH07XG4iLCJpbXBvcnQgKiBhcyBuaXBwbGVqcyBmcm9tIFwibmlwcGxlanNcIjtcbnZhciBUb3VjaENvbnRyb2wgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVG91Y2hDb250cm9sKCkge1xuICAgICAgICB2YXIgY29udHJvbERpdiA9IHRoaXMuY3JlYXRlQ29udHJvbERpdigpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbnRyb2xEaXYpO1xuICAgICAgICBuaXBwbGVqcy5jcmVhdGUoe1xuICAgICAgICAgICAgem9uZTogY29udHJvbERpdixcbiAgICAgICAgICAgIG1vZGU6ICdkeW5hbWljJyxcbiAgICAgICAgICAgIHBvc2l0aW9uOiB7IGxlZnQ6ICc1MCUnLCB0b3A6ICc1MCUnIH0sXG4gICAgICAgICAgICBjb2xvcjogJ3JlZCdcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFRvdWNoQ29udHJvbC5wcm90b3R5cGUuY3JlYXRlQ29udHJvbERpdiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBkaXYuaWQgPSAnZHluYW1pYyc7XG4gICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKCd6b25lJyk7XG4gICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKCdkeW5hbWljJyk7XG4gICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICAgICAgcmV0dXJuIGRpdjtcbiAgICB9O1xuICAgIHJldHVybiBUb3VjaENvbnRyb2w7XG59KCkpO1xuZXhwb3J0IHsgVG91Y2hDb250cm9sIH07XG4iLCJpbXBvcnQgeyBVc2VyVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHNcIjtcbmltcG9ydCB7IFRvdWNoQ29udHJvbCB9IGZyb20gXCIuL3RvdWNoXCI7XG52YXIgUGxhdGZvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUGxhdGZvcm0oKSB7XG4gICAgICAgIC8vIDxkaXYgY2xhc3M9XCJ6b25lIGR5bmFtaWMgYWN0aXZlXCI+PGgxPmR5bmFtaWM8L2gxPjwvZGl2PlxuICAgICAgICBpZiAoVXNlclV0aWxzLmlzTW9iaWxlKCkpIHtcbiAgICAgICAgICAgIG5ldyBUb3VjaENvbnRyb2woKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gUGxhdGZvcm07XG59KCkpO1xuZXhwb3J0IHsgUGxhdGZvcm0gfTtcbiIsImltcG9ydCB7IGdhbWUgfSBmcm9tIFwiLi9tb2R1bGVzXCI7XG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9hY3RvcnMvcGxheWVyXCI7XG5pbXBvcnQgeyBXb3JsZCB9IGZyb20gXCIuL3dvcmxkXCI7XG5pbXBvcnQgeyBQbGF0Zm9ybSB9IGZyb20gXCIuL21vZHVsZXMvcGxhdGZvcm1cIjtcbnZhciBtYXhGUFMgPSA2MDtcbnZhciBmcmFtZURlbGF5ID0gMTAwMCAvIG1heEZQUztcbnZhciBsYXN0RnJhbWVUaW1lID0gMDtcbnZhciBFbmdpbmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRW5naW5lKCkge1xuICAgICAgICBuZXcgUGxhdGZvcm0oKTtcbiAgICAgICAgdGhpcy53b3JsZCA9IG5ldyBXb3JsZCgpO1xuICAgICAgICB0aGlzLnBsYXllciA9IG5ldyBQbGF5ZXIoKTtcbiAgICAgICAgZ2FtZS5yZW5kZXJlci5zZXRBbmltYXRpb25Mb29wKHRoaXMuX2FuaW1hdGUuYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIEVuZ2luZS5wcm90b3R5cGUuX2FuaW1hdGUgPSBmdW5jdGlvbiAoZHQpIHtcbiAgICAgICAgdmFyIGVsYXBzZWQgPSBkdCAtIGxhc3RGcmFtZVRpbWU7XG4gICAgICAgIGlmIChlbGFwc2VkID4gZnJhbWVEZWxheSkge1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIudXBkYXRlKGR0KTtcbiAgICAgICAgICAgIGdhbWUudXBkYXRlKGR0KTtcbiAgICAgICAgICAgIGxhc3RGcmFtZVRpbWUgPSBkdCAtIChlbGFwc2VkICUgZnJhbWVEZWxheSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBFbmdpbmU7XG59KCkpO1xubmV3IEVuZ2luZSgpO1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBfX3dlYnBhY2tfbW9kdWxlc19fO1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gbm8gYmFzZVVSSVxuXG4vLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuLy8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4vLyBbcmVzb2x2ZSwgcmVqZWN0LCBQcm9taXNlXSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDE3OTogMFxufTtcblxuLy8gbm8gY2h1bmsgb24gZGVtYW5kIGxvYWRpbmdcblxuLy8gbm8gcHJlZmV0Y2hpbmdcblxuLy8gbm8gcHJlbG9hZGVkXG5cbi8vIG5vIEhNUlxuXG4vLyBubyBITVIgbWFuaWZlc3RcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5PLmogPSAoY2h1bmtJZCkgPT4gKGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9PT0gMCk7XG5cbi8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xudmFyIHdlYnBhY2tKc29ucENhbGxiYWNrID0gKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uLCBkYXRhKSA9PiB7XG5cdHZhciBbY2h1bmtJZHMsIG1vcmVNb2R1bGVzLCBydW50aW1lXSA9IGRhdGE7XG5cdC8vIGFkZCBcIm1vcmVNb2R1bGVzXCIgdG8gdGhlIG1vZHVsZXMgb2JqZWN0LFxuXHQvLyB0aGVuIGZsYWcgYWxsIFwiY2h1bmtJZHNcIiBhcyBsb2FkZWQgYW5kIGZpcmUgY2FsbGJhY2tcblx0dmFyIG1vZHVsZUlkLCBjaHVua0lkLCBpID0gMDtcblx0aWYoY2h1bmtJZHMuc29tZSgoaWQpID0+IChpbnN0YWxsZWRDaHVua3NbaWRdICE9PSAwKSkpIHtcblx0XHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcblx0XHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG5cdFx0XHRcdF9fd2VicGFja19yZXF1aXJlX18ubVttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmKHJ1bnRpbWUpIHZhciByZXN1bHQgPSBydW50aW1lKF9fd2VicGFja19yZXF1aXJlX18pO1xuXHR9XG5cdGlmKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKSBwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbihkYXRhKTtcblx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcblx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiYgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG5cdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0oKTtcblx0XHR9XG5cdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMDtcblx0fVxuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5PKHJlc3VsdCk7XG59XG5cbnZhciBjaHVua0xvYWRpbmdHbG9iYWwgPSBzZWxmW1wid2VicGFja0NodW5rY291bnRlcl9zdHJpa2VfMV82XCJdID0gc2VsZltcIndlYnBhY2tDaHVua2NvdW50ZXJfc3RyaWtlXzFfNlwiXSB8fCBbXTtcbmNodW5rTG9hZGluZ0dsb2JhbC5mb3JFYWNoKHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgMCkpO1xuY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2ggPSB3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIGNodW5rTG9hZGluZ0dsb2JhbC5wdXNoLmJpbmQoY2h1bmtMb2FkaW5nR2xvYmFsKSk7IiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBkZXBlbmRzIG9uIG90aGVyIGxvYWRlZCBjaHVua3MgYW5kIGV4ZWN1dGlvbiBuZWVkIHRvIGJlIGRlbGF5ZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy5PKHVuZGVmaW5lZCwgWzIyNV0sICgpID0+IChfX3dlYnBhY2tfcmVxdWlyZV9fKDgyOCkpKVxuX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyhfX3dlYnBhY2tfZXhwb3J0c19fKTtcbiJdLCJuYW1lcyI6WyJkZWZlcnJlZCIsInNjZW5lIiwicmVuZGVyZXIiLCJhbnRpYWxpYXMiLCJzZXRQaXhlbFJhdGlvIiwid2luZG93IiwiZGV2aWNlUGl4ZWxSYXRpbyIsInNldFNpemUiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJzaGFkb3dNYXAiLCJlbmFibGVkIiwidHlwZSIsInRvbmVNYXBwaW5nIiwiY2FtZXJhIiwicm90YXRpb24iLCJvcmRlciIsImNsb2NrIiwic3RhdHMiLCJkb2N1bWVudCIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImRvbSIsImV4dGVuZFN0YXRpY3MiLCJnYW1lIiwib2N0cmVlIiwiY29uZmlncyIsInBsYXllciIsInNwZWVkIiwianVtcFNwZWVkIiwidXBkYXRlIiwiZHQiLCJ0aGlzIiwicmVuZGVyIiwiQ2hhcmFjdGVyVXRpbHMiLCJnZXRTaWRlVmVjdG9yIiwiZGlyZWN0aW9uIiwiZ2V0V29ybGREaXJlY3Rpb24iLCJ5Iiwibm9ybWFsaXplIiwiY3Jvc3MiLCJ1cCIsIm11bHRpcGx5U2NhbGFyIiwiZ2V0Rm9yd2FyZFZlY3RvciIsIlVzZXJVdGlscyIsImlzTW9iaWxlIiwiY29uc29sZSIsImxvZyIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsInRlc3QiLCJIT1NUIiwibG9jYXRpb24iLCJocmVmIiwicGF0aFJlc29sdmVyIiwicGF0aCIsInN0YXJ0c1dpdGgiLCJlbmRzV2l0aCIsImNvbmNhdCIsInNsaWNlIiwiX19leHRlbmRzIiwiZCIsImIiLCJPYmplY3QiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIkFycmF5IiwicCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlR5cGVFcnJvciIsIlN0cmluZyIsIl9fIiwiY29uc3RydWN0b3IiLCJjcmVhdGUiLCJQbGF5ZXIiLCJfc3VwZXIiLCJfdGhpcyIsImNvbGxpZGVyIiwiQ2Fwc3VsZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImtleVN0YXRlcyIsImNvZGUiLCJyZXF1ZXN0UG9pbnRlckxvY2siLCJwb2ludGVyTG9ja0VsZW1lbnQiLCJtb3ZlbWVudFgiLCJ4IiwibW92ZW1lbnRZIiwiR0xURkxvYWRlciIsImxvYWQiLCJnbHRmIiwibW9kZWwiLCJzY2FsZSIsInNldCIsImFkZCIsImluaXRpYWxpemVkIiwiY29udHJvbHMiLCJzcGVlZERlbHRhIiwicGxheWVyT25GbG9vciIsInZlbG9jaXR5IiwidXBkYXRlUG9zaXRpb24iLCJkYW1waW5nIiwiTWF0aCIsImV4cCIsImFkZFNjYWxlZFZlY3RvciIsImRlbHRhUG9zaXRpb24iLCJjbG9uZSIsInRyYW5zbGF0ZSIsInBvc2l0aW9uIiwiY29weSIsImVuZCIsInVwZGF0ZUNvbGxpc2lvbiIsInJlc3VsdCIsImNhcHN1bGVJbnRlcnNlY3QiLCJub3JtYWwiLCJkb3QiLCJkZXB0aCIsImRlbHRhVGltZSIsIm1pbiIsImdldERlbHRhIiwiaSIsIldvcmxkIiwiYm91bmRpbmdCb3giLCJzZXRGcm9tT2JqZWN0Iiwic3ViIiwiZ2V0Q2VudGVyIiwidHJhdmVyc2UiLCJjaGlsZCIsImlzTWVzaCIsImNhc3RTaGFkb3ciLCJyZWNlaXZlU2hhZG93IiwibWF0ZXJpYWwiLCJtYXAiLCJhbmlzb3Ryb3B5Iiwib2N0cmVlSGVscGVyIiwiT2N0cmVlSGVscGVyIiwidmlzaWJsZSIsImZyb21HcmFwaE5vZGUiLCJkb21FbGVtZW50IiwiX3Jlc2l6ZSIsImJpbmQiLCJhc3BlY3QiLCJ1cGRhdGVQcm9qZWN0aW9uTWF0cml4IiwiVG91Y2hDb250cm9sIiwiY29udHJvbERpdiIsImNyZWF0ZUNvbnRyb2xEaXYiLCJuaXBwbGVqcyIsInpvbmUiLCJtb2RlIiwibGVmdCIsInRvcCIsImNvbG9yIiwiZGl2IiwiY3JlYXRlRWxlbWVudCIsImlkIiwiY2xhc3NMaXN0IiwiUGxhdGZvcm0iLCJmcmFtZURlbGF5IiwibGFzdEZyYW1lVGltZSIsIkVuZ2luZSIsIndvcmxkIiwic2V0QW5pbWF0aW9uTG9vcCIsIl9hbmltYXRlIiwiZWxhcHNlZCIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwibSIsIk8iLCJjaHVua0lkcyIsImZuIiwicHJpb3JpdHkiLCJub3RGdWxmaWxsZWQiLCJJbmZpbml0eSIsImxlbmd0aCIsImZ1bGZpbGxlZCIsImoiLCJrZXlzIiwiZXZlcnkiLCJrZXkiLCJzcGxpY2UiLCJyIiwiZGVmaW5pdGlvbiIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwiaW5zdGFsbGVkQ2h1bmtzIiwiY2h1bmtJZCIsIndlYnBhY2tKc29ucENhbGxiYWNrIiwicGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24iLCJkYXRhIiwibW9yZU1vZHVsZXMiLCJydW50aW1lIiwic29tZSIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJmb3JFYWNoIiwicHVzaCIsIl9fd2VicGFja19leHBvcnRzX18iXSwic291cmNlUm9vdCI6IiJ9